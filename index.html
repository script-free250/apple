<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Apple of Fortune</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');

        * { box-sizing: border-box; user-select: none; font-family: 'Cairo', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; padding: 0; background-color: #111; min-height: 100vh; display: flex; justify-content: center; align-items: center; }

        /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„ØªÙŠ ØªØ¶Ù…Ù† ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ØµÙˆØ±Ø© Ù…Ø¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .game-wrapper {
            position: relative;
            width: 100%;
            max-width: 500px; /* Ø¹Ø±Ø¶ Ø£Ù‚ØµÙ‰ ÙŠØ´Ø¨Ù‡ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            line-height: 0; /* Ù„Ø¥Ø²Ø§Ù„Ø© Ù…Ø³Ø§ÙØ§Øª Ø§Ù„ØµÙˆØ± */
        }

        /* Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
        .bg-image {
            width: 100%;
            height: auto;
            display: block;
        }

        /* Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø´ÙØ§ÙØ© ÙÙˆÙ‚ Ø§Ù„ØµÙˆØ±Ø© */
        .overlay-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            line-height: normal;
        }

        /* ============================================================
           ÙˆØ¶Ø¹ Ø§Ù„ØªØµØ­ÙŠØ­ (Testing Mode)
           Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ Ù„ØªØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø£Ù…Ø§ÙƒÙ†.
           Ù„Ø­Ø°ÙÙ‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹: Ø§Ø¬Ø¹Ù„ border: none; Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† border: 1px solid red;
           ============================================================ */
        .debug-border {
            border: 1px solid rgba(255, 0, 0, 0.5); /* Ø­Ø¯ÙˆØ¯ Ø­Ù…Ø±Ø§Ø¡ Ù…Ø¤Ù‚ØªØ© */
            background-color: rgba(255, 0, 0, 0.1); /* Ø®Ù„ÙÙŠØ© Ø­Ù…Ø±Ø§Ø¡ Ø®ÙÙŠÙØ© */
        }

        /* 1. Ø¶Ø¨Ø· Ù…ÙƒØ§Ù† Ø§Ù„Ø±ØµÙŠØ¯ */
        .balance-box {
            position: absolute;
            top: 5.5%; left: 35%; width: 30%; height: 4%;
            display: flex; justify-content: center; align-items: center;
            color: #fff; font-weight: bold; font-size: 1.2rem;
            background: #222; border-radius: 50px; z-index: 2;
        }

        /* 2. Ø¶Ø¨Ø· Ø´Ø¨ÙƒØ© Ø§Ù„Ù„Ø¹Ø¨ (Ø§Ù„ØªÙØ§Ø­) */
        .grid-container {
            position: absolute;
            top: 17.5%; /* Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø´Ø¨ÙƒØ© Ù…Ù† Ø§Ù„Ø§Ø¹Ù„Ù‰ */
            left: 17%;  /* Ø§Ù„Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„ÙŠØ³Ø§Ø± */
            width: 80%; /* Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø¨ÙƒØ© */
            height: 52%; /* Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø´Ø¨ÙƒØ© */
            display: flex; flex-direction: column-reverse;
            gap: 1%;
            z-index: 5;
        }

        .row { flex: 1; display: flex; gap: 2%; }
        .cell {
            flex: 1;
            cursor: pointer;
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
        }
        
        /* Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª (ØªÙØ§Ø­Ø©/Ø¯ÙˆØ¯Ø©) */
        .cell span { font-size: 1.5rem; display: none; filter: drop-shadow(0 2px 2px black); }

        /* 3. Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø³ÙÙ„ÙŠØ© */
        .controls-row {
            position: absolute;
            bottom: 21.2%; left: 3%; width: 94%; height: 5.5%;
            display: flex; gap: 2%; z-index: 10;
        }
        .ctrl-btn { flex: 1; cursor: pointer; border-radius: 5px; }

        /* 4. Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‡Ø§Ù† */
        .bet-input {
            position: absolute;
            bottom: 11.5%; right: 5%; width: 35%; height: 6%;
            background: #333; border: none; color: white;
            font-size: 1.2rem; font-weight: bold; text-align: center;
            border-radius: 8px; z-index: 10;
        }

        /* 5. Ø²Ø± Ø§Ù„Ø±Ù‡Ø§Ù† Ø§Ù„ÙƒØ¨ÙŠØ± */
        .action-btn {
            position: absolute;
            bottom: 11.5%; left: 5%; width: 30%; height: 6%;
            cursor: pointer; z-index: 10; border-radius: 8px;
            display: flex; justify-content: center; align-items: center;
        }
        .action-text {
            color: white; font-weight: bold; font-size: 1.1rem;
            background: green; padding: 2px 10px; border-radius: 5px;
            display: none; /* Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§ */
        }

        /* Ø±Ø³Ø§Ø¦Ù„ */
        .msg {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9); color: #fff; padding: 20px;
            border: 2px solid #ffc107; border-radius: 10px; text-align: center;
            display: none; z-index: 100; min-width: 200px;
        }
    </style>
</head>
<body>

    <div class="game-wrapper">
        <img src="image_3d1fdb.jpg" class="bg-image" alt="Game Background">

        <div class="overlay-layer">
            <div class="balance-box" id="balanceDisplay">105.00 UM</div>

            <div class="grid-container debug-border" id="grid"></div>

            <div class="controls-row">
                <div class="ctrl-btn debug-border" onclick="setBet('min')"></div> <div class="ctrl-btn debug-border" onclick="setBet('x2')"></div>
                <div class="ctrl-btn debug-border" onclick="setBet('div2')"></div>
                <div class="ctrl-btn debug-border" onclick="setBet('max')"></div> </div>

            <div class="action-btn debug-border" id="mainBtn" onclick="play()">
                <span class="action-text" id="btnText">Ø³Ø­Ø¨</span>
            </div>

            <input type="number" class="bet-input" id="betAmount" value="20.00">
        </div>

        <div id="msgModal" class="msg">
            <h3 id="msgTitle"></h3>
            <p id="msgBody"></p>
        </div>
    </div>

    <script>
        // Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ
        const odds = [1.23, 1.54, 1.93, 2.41, 4.02, 6.71, 11.18, 27.97, 69.93, 349.68];
        let balance = 105.00;
        let currentBet = 20.00;
        let activeRow = 0;
        let isPlaying = false;

        const gridDiv = document.getElementById('grid');
        const balDiv = document.getElementById('balanceDisplay');
        const betInp = document.getElementById('betAmount');
        const btnText = document.getElementById('btnText');
        const modal = document.getElementById('msgModal');

        // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø´Ø¨ÙƒØ©
        function initGrid() {
            gridDiv.innerHTML = '';
            for(let i=0; i<10; i++) {
                let row = document.createElement('div');
                row.className = 'row';
                row.id = `row-${i}`;
                for(let j=0; j<5; j++) {
                    let cell = document.createElement('div');
                    cell.className = 'cell debug-border'; // Ø­Ø¯ÙˆØ¯ Ù„Ù„ØªØ¬Ø±Ø¨Ø©
                    cell.onclick = () => clickCell(i, j, cell);
                    let sp = document.createElement('span');
                    cell.appendChild(sp);
                    row.appendChild(cell);
                }
                gridDiv.appendChild(row);
            }
        }

        function play() {
            if(!isPlaying) {
                // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨
                let val = parseFloat(betInp.value);
                if(val > balance || val < 1) return alert('ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯');
                
                balance -= val;
                currentBet = val;
                isPlaying = true;
                activeRow = 0;
                updateUI();
                
                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø´Ø¨ÙƒØ©
                document.querySelectorAll('.cell span').forEach(s => s.style.display='none');
                
                // ØªØºÙŠÙŠØ± Ø§Ù„Ø²Ø±
                btnText.style.display = 'block'; // Ø¥Ø¸Ù‡Ø§Ø± ÙƒÙ„Ù…Ø© "Ø³Ø­Ø¨"
                
            } else {
                // Ø³Ø­Ø¨
                cashOut();
            }
        }

        function clickCell(r, c, el) {
            if(!isPlaying || r !== activeRow) return;

            let span = el.querySelector('span');
            let win = Math.random() > 0.2; // Ø§Ø­ØªÙ…Ø§Ù„ ÙÙˆØ²

            span.style.display = 'block';
            if(win) {
                span.innerText = 'ğŸ';
                activeRow++;
                if(activeRow >= 10) cashOut(true);
            } else {
                span.innerText = 'ğŸ›';
                gameOver();
            }
        }

        function cashOut(all=false) {
            let mult = activeRow > 0 ? odds[activeRow-1] : 0;
            if(activeRow === 0 && !all) mult = 0;
            
            let w = currentBet * mult;
            balance += w;
            endGame(`Ù…Ø¨Ø±ÙˆÙƒ! Ø±Ø¨Ø­Øª ${w.toFixed(2)}`);
        }

        function gameOver() {
            endGame('Ø­Ø¸ Ø£ÙˆÙØ±!');
        }

        function endGame(txt) {
            isPlaying = false;
            updateUI();
            btnText.style.display = 'none'; // Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„Ù…Ø© Ø³Ø­Ø¨ Ù„ÙŠØ¹ÙˆØ¯ Ø§Ù„Ø²Ø± Ù„Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©
            
            document.getElementById('msgTitle').innerText = txt;
            document.getElementById('msgBody').innerText = '';
            modal.style.display = 'block';
            setTimeout(() => modal.style.display='none', 2000);
        }

        function updateUI() {
            balDiv.innerText = balance.toFixed(2) + ' UM';
        }

        function setBet(t) {
            let v = parseFloat(betInp.value);
            if(t==='min') v=10;
            if(t==='max') v=balance;
            if(t==='x2') v*=2;
            if(t==='div2') v/=2;
            betInp.value = v.toFixed(2);
        }

        initGrid();
    </script>
</body>
</html>
