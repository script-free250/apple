<!DOCTYPE html>
<html lang="ar" dir="ltr"> <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Apple Of Fortune</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@500;700&display=swap');

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Roboto', sans-serif;
        }

        body {
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù‡Ø§ØªÙ */
        #app {
            width: 100%;
            max-width: 414px; /* Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            height: 100vh;
            background: url('bg.png') no-repeat center center;
            background-size: cover;
            background-color: #162c26; /* Ù„ÙˆÙ† Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø§Ø®Ø¶Ø± ØºØ§Ù…Ù‚ */
            display: flex;
            flex-direction: column;
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        /* --- Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ --- */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            height: 60px;
            background: rgba(0,0,0,0.2);
        }

        .header-left, .header-right {
            color: #fff;
            font-size: 20px;
            opacity: 0.8;
            width: 40px;
            text-align: center;
        }

        .balance-pill {
            background: rgba(0,0,0,0.5);
            padding: 5px 15px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .coin {
            width: 18px;
            height: 18px;
            background: #ffc107;
            border-radius: 50%;
            display: inline-block;
            box-shadow: 0 0 5px #ffc107;
        }

        .balance-text {
            color: #fff;
            font-weight: bold;
            font-size: 15px;
        }

        /* --- Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù„Ø¹Ø¨Ø© --- */
        .game-title {
            text-align: center;
            color: rgba(255,255,255,0.7);
            font-size: 12px;
            margin-top: 5px;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* --- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨ --- */
        .game-area {
            flex: 1;
            display: flex;
            justify-content: center; /* ØªÙˆØ³ÙŠØ· Ø£ÙÙ‚ÙŠ */
            align-items: center;    /* ØªÙˆØ³ÙŠØ· Ø¹Ù…ÙˆØ¯ÙŠ */
            padding-bottom: 100px; /* Ù…Ø³Ø§Ø­Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø³ÙÙ„ÙŠØ© */
        }

        .board {
            display: flex;
            flex-direction: column-reverse; /* Ù„ØªØ¨Ø¯Ø£ Ø§Ù„ØµÙÙˆÙ Ù…Ù† Ø§Ù„Ø£Ø³ÙÙ„ */
            gap: 6px;
        }

        .row {
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            padding-left: 60px; /* Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ù…Ø¶Ø§Ø¹Ù Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± */
        }

        /* ÙƒØ¨Ø³ÙˆÙ„Ø© Ø§Ù„Ù…Ø¶Ø§Ø¹Ù (Odds) */
        .multiplier {
            position: absolute;
            left: 0;
            background: rgba(13, 29, 36, 0.9);
            color: #8c9fa8;
            font-size: 10px;
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 10px;
            width: 55px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.05);
        }

        /* Ø§Ù„ØµÙ Ø§Ù„Ù†Ø´Ø· */
        .row.active .multiplier {
            color: #fff;
            background: rgba(20, 50, 40, 0.9);
            border-color: #4caf50;
            box-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
        }

        /* Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø®Ø´Ø¨ÙŠØ© (Ø§Ù„Ø®Ù„Ø§ÙŠØ§) */
        .cell {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            /* Ù…Ø­Ø§ÙƒØ§Ø© Ø´ÙƒÙ„ Ø§Ù„Ø®Ø´Ø¨ ÙˆÙ„ÙˆÙ†Ù‡ */
            background: radial-gradient(circle, #5d4037 30%, #3e2723 90%);
            border: 2px solid #281812;
            box-shadow: 0 3px 5px rgba(0,0,0,0.5);
            cursor: pointer;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¶ØºØ· */
        .cell:active { transform: scale(0.95); }

        /* Ø§Ù„ØµÙÙˆÙ ØºÙŠØ± Ø§Ù„Ù†Ø´Ø·Ø© */
        .row.disabled .cell {
            opacity: 0.6;
            filter: brightness(0.7);
            pointer-events: none;
        }

        /* Ø§Ù„ØµÙˆØ± Ø¯Ø§Ø®Ù„ Ø§Ù„Ø®Ù„ÙŠØ© */
        .cell img {
            width: 90%;
            height: 90%;
            object-fit: contain;
            display: none;
            filter: drop-shadow(0 4px 2px rgba(0,0,0,0.4));
            animation: popUp 0.3s ease;
            z-index: 2;
        }
        
        .cell.revealed img { display: block; }

        /* --- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø³ÙÙ„ÙŠØ© --- */
        .controls {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: #1b242d;
            padding: 15px;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
        }

        /* Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø±Ù‡Ø§Ù† */
        .bet-selector {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #12181f;
            border-radius: 8px;
            padding: 5px;
            border: 1px solid #2a3540;
        }

        .bet-btn-small {
            width: 40px;
            height: 40px;
            background: #2c3844;
            color: #fff;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            font-weight: bold;
        }

        .bet-input {
            background: transparent;
            border: none;
            color: #fff;
            text-align: center;
            font-size: 16px;
            font-weight: bold;
            width: 100px;
            outline: none;
        }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .action-btn {
            width: 100%;
            height: 50px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            color: #fff;
            cursor: pointer;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
            transition: 0.1s;
        }

        .btn-green {
            background: linear-gradient(180deg, #81c784 0%, #388e3c 100%);
        }
        
        .btn-green:active { transform: translateY(2px); box-shadow: none; }

        .btn-orange {
            background: linear-gradient(180deg, #ffd54f 0%, #ff6f00 100%);
            color: #000;
            display: none; /* Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
        }

        @keyframes popUp {
            0% { transform: scale(0); }
            80% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© */
        .overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        .msg-box {
            background: #263238;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            color: #fff;
            border: 2px solid #455a64;
            min-width: 250px;
        }
    </style>
</head>
<body>

    <div id="app">
        <header>
            <div class="header-left">â®</div>
            <div class="balance-pill">
                <span class="coin"></span>
                <span id="balanceText">95.00 UM</span>
            </div>
            <div class="header-right">â˜°</div>
        </header>

        <div class="game-title">APPLE OF FORTUNE</div>

        <div class="game-area">
            <div class="board" id="board">
                </div>
        </div>

        <div class="controls">
            <div class="bet-selector">
                <button class="bet-btn-small" onclick="changeBet(-5)">-</button>
                <input type="number" id="betInput" class="bet-input" value="10" readonly>
                <button class="bet-btn-small" onclick="changeBet(5)">+</button>
            </div>
            
            <button id="startBtn" class="action-btn btn-green" onclick="startGame()">Place a bet</button>
            <button id="cashoutBtn" class="action-btn btn-orange" onclick="cashOut()">Take Winnings</button>
        </div>

        <div class="overlay" id="resultOverlay" onclick="this.style.display='none'">
            <div class="msg-box">
                <h2 id="resTitle">YOU WON!</h2>
                <h3 id="resAmount" style="margin-top:10px; color:#ffd54f;">15.00</h3>
                <p style="margin-top:15px; font-size:12px; opacity:0.6;">Tap to continue</p>
            </div>
        </div>
    </div>

    <script>
        // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ø£Ø±Ù‚Ø§Ù… ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„ØµÙˆØ±Ø©
        const ODDS = [4.02, 6.71, 11.18, 27.97, 69.93, 349.68, 1748.4, 8742.0, 43710, 218550];
        const ROWS = 10;
        const COLS = 5;

        let balance = 95.00;
        let currentBet = 10;
        let currentRow = 0;
        let isPlaying = false;
        let gameMap = []; // Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù‚Ù†Ø§Ø¨Ù„

        // Ø¹Ù†Ø§ØµØ± HTML
        const board = document.getElementById('board');
        const balanceTxt = document.getElementById('balanceText');
        const betInp = document.getElementById('betInput');
        const startBtn = document.getElementById('startBtn');
        const cashoutBtn = document.getElementById('cashoutBtn');
        const overlay = document.getElementById('resultOverlay');

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
        function init() {
            board.innerHTML = '';
            for(let r = ROWS-1; r >= 0; r--) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'row disabled';
                rowDiv.id = `row-${r}`;

                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¶Ø§Ø¹Ù Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø±
                const multDiv = document.createElement('div');
                multDiv.className = 'multiplier';
                multDiv.innerText = 'x' + ODDS[r].toFixed(2);
                rowDiv.appendChild(multDiv);

                // Ø¥Ø¶Ø§ÙØ© 5 Ø®Ù„Ø§ÙŠØ§
                for(let c=0; c<COLS; c++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.onclick = () => clickCell(r, c);
                    
                    const img = document.createElement('img');
                    img.id = `img-${r}-${c}`;
                    // Ù‡Ø°Ù‡ Ø§Ù„Ù†ØµÙˆØµ Ø³ØªØ¸Ù‡Ø± ÙÙ‚Ø· Ø¥Ø°Ø§ Ù„Ù… ØªØ±ÙØ¹ Ø§Ù„ØµÙˆØ±
                    img.alt = ""; 
                    
                    cell.appendChild(img);
                    rowDiv.appendChild(cell);
                }
                board.appendChild(rowDiv);
            }
            updateUI();
        }

        // ØªØºÙŠÙŠØ± Ø§Ù„Ø±Ù‡Ø§Ù†
        function changeBet(amount) {
            if(isPlaying) return;
            currentBet += amount;
            if(currentBet < 1) currentBet = 1;
            if(currentBet > balance) currentBet = balance;
            updateUI();
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
        function startGame() {
            if(currentBet > balance) { alert('Ø§Ù„Ø±ØµÙŠØ¯ Ù„Ø§ ÙŠÙƒÙÙŠ'); return; }
            
            balance -= currentBet;
            isPlaying = true;
            currentRow = 0;
            
            // Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù„Ø¹Ø¨Ø©
            startBtn.style.display = 'none';
            cashoutBtn.style.display = 'none'; // Ø³ÙŠØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„ÙÙˆØ² Ø¨Ø£ÙˆÙ„ Ù…Ø±Ø­Ù„Ø©
            
            // ØªÙˆÙ„ÙŠØ¯ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ù‚Ù†Ø§Ø¨Ù„
            generateBombs();
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… Ø§Ù„Ø¨ÙˆØ±Ø¯ Ù†Ø¸ÙŠÙ
            init(); 
            
            // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„
            document.getElementById(`row-0`).classList.remove('disabled');
            document.getElementById(`row-0`).classList.add('active');
            
            updateUI();
        }

        function generateBombs() {
            gameMap = [];
            for(let r=0; r<ROWS; r++) {
                // ØµØ¹ÙˆØ¨Ø© Ù…ØªØ¯Ø±Ø¬Ø©: ÙƒÙ„Ù…Ø§ ØµØ¹Ø¯Ù†Ø§ Ø²Ø§Ø¯ Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ù†Ø§Ø¨Ù„
                let bombs = 1;
                if(r > 2) bombs = 2;
                if(r > 6) bombs = 3;
                if(r > 8) bombs = 4;
                
                let rowArr = Array(5).fill('good');
                for(let k=0; k<bombs; k++) {
                    let idx;
                    do { idx = Math.floor(Math.random()*5); } while(rowArr[idx] === 'bad');
                    rowArr[idx] = 'bad';
                }
                gameMap.push(rowArr);
            }
        }

        function clickCell(r, c) {
            if(!isPlaying || r !== currentRow) return;
            
            const cellImg = document.getElementById(`img-${r}-${c}`);
            const cellDiv = cellImg.parentElement;
            
            // Ù…Ù†Ø¹ Ø§Ù„Ø¶ØºØ· Ù…Ø±ØªÙŠÙ†
            if(cellDiv.classList.contains('revealed')) return;
            
            cellDiv.classList.add('revealed');
            
            if(gameMap[r][c] === 'good') {
                // ÙÙˆØ²
                cellImg.src = 'apple.png';
                // Ù„Ùˆ Ø§Ù„ØµÙˆØ±Ø© Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯Ø© Ø­Ø· Ù†Øµ Ù…Ø¤Ù‚Øª
                cellImg.onerror = () => { cellDiv.innerHTML = '<span style="font-size:24px">ğŸ</span>'; };
                
                winRow(r);
            } else {
                // Ø®Ø³Ø§Ø±Ø©
                cellImg.src = 'rotten.png';
                cellImg.onerror = () => { cellDiv.innerHTML = '<span style="font-size:24px">ğŸ›</span>'; };
                
                gameOver();
            }
        }

        function winRow(r) {
            // Ù‚ÙÙ„ Ø§Ù„ØµÙ Ø§Ù„Ø­Ø§Ù„ÙŠ
            const rowDiv = document.getElementById(`row-${r}`);
            rowDiv.classList.remove('active');
            rowDiv.classList.add('disabled');
            // Ø¬Ø¹Ù„ Ø§Ù„Ø®Ù„ÙŠØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© ÙˆØ§Ø¶Ø­Ø©
            rowDiv.querySelector('.revealed').style.pointerEvents = 'auto'; 
            rowDiv.querySelector('.revealed').style.opacity = '1';

            currentRow++;
            
            // ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„Ø³Ø­Ø¨
            const winVal = (currentBet * ODDS[r]).toFixed(2);
            cashoutBtn.innerText = `TAKE ${winVal}`;
            cashoutBtn.style.display = 'block';

            if(currentRow >= ROWS) {
                cashOut();
            } else {
                // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙ Ø§Ù„ØªØ§Ù„ÙŠ
                const nextRow = document.getElementById(`row-${currentRow}`);
                nextRow.classList.remove('disabled');
                nextRow.classList.add('active');
            }
        }

        function gameOver() {
            isPlaying = false;
            // ÙƒØ´Ù Ø§Ù„Ù‚Ù†Ø§Ø¨Ù„ ÙÙŠ Ø§Ù„ØµÙ Ø§Ù„Ø­Ø§Ù„ÙŠ
            showRowDetails(currentRow);
            setTimeout(() => {
                showMsg('YOU LOST', 'Better luck next time');
                resetGame();
            }, 1000);
        }

        function cashOut() {
            if(!isPlaying) return;
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¨Ø­ Ù…Ù† Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¨Ù‚ (Ù„Ø£Ù†Ù‡ currentRow Ø²Ø§Ø¯ 1 Ø¨Ø§Ù„ÙØ¹Ù„)
            let winIdx = currentRow - 1;
            let winAmount = currentBet * ODDS[winIdx];
            
            balance += winAmount;
            isPlaying = false;
            
            showMsg('VICTORY!', winAmount.toFixed(2) + ' UM');
            resetGame();
        }

        function resetGame() {
            startBtn.style.display = 'block';
            cashoutBtn.style.display = 'none';
            // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            updateUI();
        }

        function showRowDetails(r) {
            // Ø¥Ø¸Ù‡Ø§Ø± Ø¨Ø§Ù‚ÙŠ Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„ØµÙ
            for(let c=0; c<5; c++) {
                const img = document.getElementById(`img-${r}-${c}`);
                if(!img.parentElement.classList.contains('revealed')) {
                    img.parentElement.classList.add('revealed');
                    img.parentElement.style.opacity = '0.5';
                    if(gameMap[r][c] === 'good') img.src = 'apple.png';
                    else img.src = 'rotten.png';
                }
            }
        }

        function showMsg(title, body) {
            document.getElementById('resTitle').innerText = title;
            document.getElementById('resAmount').innerText = body;
            overlay.style.display = 'flex';
        }

        function updateUI() {
            balanceTxt.innerText = balance.toFixed(2) + ' UM';
            betInp.value = currentBet;
        }

        // ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ Ù…Ø±Ø©
        init();

    </script>
</body>
</html>
